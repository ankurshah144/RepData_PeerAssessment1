---
title: "RepData Assignment_1.Rmd"
output: html_document
description: R Markdown document for Coursera course "Reproducible Research", Peer Assessment 1
---
# Reproducible Research: Peer Assessment 1
R Markdown document for Reproducible Research Peer Assessment 1

## Loading and preprocessing the data
```{r preprocessing}
setwd("~/DS Toolbox/Github/RepData_PeerAssessment1")
activity <- read.csv("activity.csv")  # read file
#activity$date <- as.Date(activity$date, "%Y-%m-%d")  # convert date column to date data type
```

## What is mean total number of steps taken per day?
1. Histogram with number of steps for each day
```{r dailysteps_hist}
dailysteps <- tapply(activity$steps, activity$date, sum, na.rm=TRUE)  # calculate daily steps
library(lattice)
histogram(dailysteps, type="count", breaks=length(dailysteps), col="gray")  # generate histogram
```

2. **mean** and **median** total number of steps taken per day
```{r mean_median}
mean(dailysteps)  # mean
median(dailysteps)  # median
summary(dailysteps)  # different approach
```

## What is the average daily activity pattern?
1. Time-series plot of the 5-minute interval and average number of steps taken
```{r interval_average}
intervalsteps <- sapply(split(activity$steps, activity$interval)
                            , mean, na.rm=TRUE)  # 5 min interval avg
library(ggplot2)
qplot(as.numeric(names(intervalsteps)), intervalsteps
            , geom="line", xlab="Time of Day HHMM", ylab="Average Steps")  # generate plot
```

2. Identify the 5-min interval that contains the maximum number of steps
```{r max_daily_steps}
moststeps <- order(intervalsteps, decreasing=TRUE)  # daily average in decreasing order
intervalsteps[moststeps[1]]  # interval with maximum number of steps
```

## Inputting missing values
1. Total number of missing values in the dataset
```{r total_na}
sum(is.na(activity$steps))
```
2. Creating a strategy to fill-in missing values in the dataset
```{r na_strategy}
# filler function -- 10% of average of each day; if not available, '5'
filler <- function(x) {
    if (is.nan(mean(x, na.rm=TRUE)))  5
    else mean(x, na.rm=TRUE)/10
}
dailymean <- tapply(activity$steps, activity$date, filler)
```
3. New dataset copied from the original, but with missing values filled-in
```{r na_filler}
newactivity <- activity
# fetch array of dates and values corresponding to NA steps and apply to missing values
newactivity <- within(newactivity
                        , steps[is.na(steps)] <- dailymean[newactivity$date[is.na(newactivity$steps)]])
```
4. 3-parts
* Histogram of new total steps per day
```{r newdata_hist}
new.dailysteps <- tapply(newactivity$steps, newactivity$date, sum, na.rm=TRUE)  # calculate daily steps
histogram(new.dailysteps, type="count", breaks=length(new.dailysteps), col="gray")  # generate histogram
```

* Compare mean and median against previously calculated values

```{r newdata_mm}
c(old.mean = mean(new.dailysteps), new.mean = mean(dailysteps))
c(old.median = median(new.dailysteps), new.median = median(dailysteps))
```

<span style="color:blue">
Interesting results - mean has increased, but median remains the same!
</span>

## Are there differences in activity patterns between weekdays and weekends?
